/*****//* (c) Copyright FacioCMS Maciej DÄ™bowski 2021-today *//*****/
/*****/ 

console.log("%cWARNING!","font-size: 100px; color: red;"),console.log("%cThis part of browser is Developer-only. Please don't paste any script here if you don't understand it. By executing scripts hackers could stole your APIToken which could be used to hack into your account or edit your page","color: red; font-size: 40px;"),console.log(`%cMore informations about this: ${window.location.origin+window.location.pathname}docs/aboutxss.html`,"color: red; font-size: 30px;"),console.log("%cWARNING! /\\","font-size: 100px; color: red;"),console.log("%cNeed Help? Discord: https://discord.gg/QJCBtfbx","color: #5865F2;");const $=e=>document.querySelector(e),$all=e=>document.querySelectorAll(e),request=(e,t,n)=>{const o=new XMLHttpRequest;return o.open(e,t),o.send(n),o},Mouse={x:0,y:0};function RouteChange(e){document.body.innerHTML+=`<form method="POST" style="display: none;">\n        REDIRECTING\n        <input type="text" name="route" value="${e}">\n        <button id="click-send"></button>\n    </form>`,$("#click-send").click()}$(".cms-version i").innerHTML=`v. ${window._appData.version}`,-1!=window.location.href.indexOf("#!")&&(window.location.href=window.location.href.split("#!").join("")),window.faciocms={prompt:e=>new Promise(t=>{$("#prompt-section").innerHTML+=`<div class="prompt-box">\n                <label for="prompt-box-input" class="label-prompt-box">${e}</label>\n                <input id="prompt-box-input" type="text"> <button class="button-save-prompt"><em class="fas fa-check"></em></button>\n            </div>`,$(".button-save-prompt").addEventListener("click",()=>{t($("#prompt-box-input").value),$(".prompt-box").remove()}),$("#prompt-box-input").addEventListener("keyup",e=>{"Enter"==e.key&&(t($("#prompt-box-input").value),$(".prompt-box").remove())})}),keywordsToInput(){const e=[];$all(".keyword-item").forEach(t=>e.push(t.innerHTML)),$("#keywords-meta-input").value="",e.forEach((t,n)=>{$("#keywords-meta-input").value+=`${t}${n!=e.length-1?",":""}`})}},$all(".redirect-nav-item").forEach(e=>e.addEventListener("click",()=>{RouteChange(e.dataset.route)})),"home"==$("#routeid").innerHTML&&RouteChange("Pages"),window.history.replaceState;const APIUrl=`${window.location.origin}${window.location.pathname}versions/${window._appData.version}/api/`,authToken=$("#authtoken").innerHTML;if($("#add-global-page")&&($("#add-global-page").addEventListener("click",()=>{request("POST",`${APIUrl}createpage.php?authToken=${authToken}&parentid=-1`,"").addEventListener("readystatechange",()=>{window.location.reload()})}),$all(".btn-add-subpage").forEach(e=>e.addEventListener("click",()=>{const t=request("POST",`${APIUrl}createpage.php?authToken=${authToken}&parentid=${e.dataset.pageid}`,"");t.addEventListener("readystatechange",()=>{console.log(t.responseText),window.location.reload()})})),$all(".btn-edit-page").forEach(e=>e.addEventListener("click",()=>{RouteChange(`pageedit:${e.dataset.pageid}`)}))),$all(".btn-remove-page, .btn-removepage").length>0&&$all(".btn-remove-page, .btn-removepage").forEach(e=>e.addEventListener("click",()=>{request("POST",`${APIUrl}deletepage.php?authToken=${authToken}&id=${e.dataset.pageid}`,"").addEventListener("readystatechange",()=>window.location.reload())})),$('[text-editor-for="pagecontent_send"]')&&$('[text-editor-for="pagecontent_send"]').addEventListener("keyup",()=>{$("#pagecontent_send").value=$('[text-editor-for="pagecontent_send"]').innerHTML}),$(".btn-text-editor-tool")&&$all(".btn-text-editor-tool").forEach(e=>e.addEventListener("click",()=>(document.execCommand(e.dataset.command),$("#pagecontent_send").value=$('[text-editor-for="pagecontent_send"]').innerHTML,!1))),$("#authtoken__api")&&($("#authtoken__api").value=authToken),$(".add-addon-key")&&$(".add-addon-key").addEventListener("click",async()=>{const e=await window.faciocms.prompt("Name?: ");$(".addons-container-div").innerHTML+=`<div class="row-page-addon">\n            <div class="row-page-addon-left">\n                ${e}\n            </div>\n            <div class="row-page-addon-right">\n                <input class="row-page-addon-input" value="" name="${e}" type="text">\n            </div>\n        </div>`,$("#saveaddonsbutton").click(),setTimeout(()=>RouteChange($("#pageroute_name").value),50)}),$all(".link-remove-addon").forEach(e=>{e.addEventListener("click",()=>{e.href=`versions/${window._appData.version}/api/deleteaddon.php?apiauth=${authToken}&addonId=${e.dataset.addonid}`,setTimeout(()=>RouteChange($("#pageroute_name").value),50)})}),$(".remove-user-button-as-link")&&$all(".remove-user-button-as-link").forEach(e=>{e.href=`versions/${window._appData.version}/api/deleteuser.php?apiauth=${authToken}&userId=${e.dataset.userid}`,e.addEventListener("click",()=>setTimeout(()=>{RouteChange("Users")},50))}),$(".add-new-user-button")&&$(".add-new-user-button").addEventListener("click",async()=>{const e=await window.faciocms.prompt("Username: ?"),t=await window.faciocms.prompt("Password: ?");request("GET",`${window.location.origin}${window.location.pathname}versions/${window._appData.version}/api/createuser.php?apiauth=${authToken}&user=${e}&password=${t}`,"").addEventListener("readystatechange",()=>{RouteChange("Users")})}),$("#keyword-add-input")){function addKeyword(e="normal"){const t=[];$all(".keyword-item").forEach(e=>t.push(e.innerHTML));let n=$("#keyword-add-input").value;""!=n&&(t.includes(n)||("decrement1"==e&&(n=n.substr(0,n.length-1)),$("#keyword-add-input").value="",$(".group-of-keywords").innerHTML+=`\n            <div class="keyword-item" onclick="this.remove(); window.faciocms.keywordsToInput();">${n}</div>\n        `,window.faciocms.keywordsToInput()))}$("#keyword-add-input").addEventListener("keyup",e=>{"Tab"==e.key||"Enter"==e.key?addKeyword():","==e.key&&addKeyword("decrement1")}),$("#keyword-add-input").addEventListener("keydown",e=>{if("Enter"==e.key)return e.preventDefault(),!1})}$(".btn-delete-pernamently")&&$all(".btn-delete-pernamently").forEach(e=>e.addEventListener("click",()=>{window.open(`${window.location.href}versions/${window._appData.version}/api/pernamentlydeletepage.php?authtoken=${authToken}&id=${e.dataset.pageid}`,"_blank"),setTimeout(()=>window.location.reload(),25)})),$(".btn-restore-page")&&$all(".btn-restore-page").forEach(e=>e.addEventListener("click",()=>{window.open(`${window.location.href}versions/${window._appData.version}/api/restorepage.php?authtoken=${authToken}&id=${e.dataset.pageid}`,"_blank"),setTimeout(()=>window.location.reload(),25)})),$(".btn-start-updating")&&$(".btn-start-updating").addEventListener("click",()=>{window.open(`${window.location.origin}${window.location.pathname}versions/${window._appData.version}/api/updater.php`)}),$(".save-user-info")&&($(".save-user-info").addEventListener("click",async()=>{const e=await window.faciocms.prompt("Password?:");$("#oldpassword__user").value=e,$(".profile-configurate").submit()}),$("#username___form_user_info").addEventListener("keydown",e=>{if("Enter"==e.key)return e.preventDefault(),!1})),$(".roll-dropdown-button")&&$all(".roll-dropdown-button:not(.disabled__dropdown)").forEach(e=>{e.addEventListener("click",()=>{document.querySelector(`[data-dropdownid="${e.getAttribute("data-dropdown-id")}"]`).classList.toggle("show"),e.querySelector("em").classList.toggle("subchilds-navigation-down"),e.querySelector("em").classList.toggle("subchilds-navigation-right")})}),$("body").addEventListener("mousemove",e=>{Mouse.x=e.clientX,Mouse.y=e.clientY}),$("body").addEventListener("contextmenu",e=>($(".context-menu-new").style.left=Mouse.x+"px",$(".context-menu-new").style.top=Mouse.y+"px",e.preventDefault(),!1)),$(".adminpanel").addEventListener("click",()=>{$(".context-menu-new").style.left=1e4+"px",$(".context-menu-new").style.top=1e4+"px"});